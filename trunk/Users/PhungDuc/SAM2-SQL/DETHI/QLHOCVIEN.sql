CREATE DATABASE QL_HOCVIEN_SCRIPT
USE QL_HOCVIEN_SCRIPT

-- TAO BANG STUDENT
IF EXISTS (SELECT * FROM DBO.SYSOBJECTS WHERE NAME='STUDENT')
BEGIN
	DROP TABLE STUDENT
END
GO
CREATE TABLE STUDENT
(
	STUDENTID	CHAR(5),
	STUDENTNAME	NVARCHAR(50),
	DOB			DATETIME,
	SEX			CHAR(5),
	ADDRESS		NVARCHAR(100)
	PRIMARY KEY(STUDENTID)
)
--TAO BANG SUBJECT
IF EXISTS (SELECT * FROM DBO.SYSOBJECTS WHERE NAME='SUBJECT')
BEGIN
	DROP TABLE SUBJECT
END
GO
CREATE TABLE SUBJECT
(
	SUBJECTID	CHAR(5),
	SUBJECTNAME	NVARCHAR(50),
	CREDIT		INT,
	FEE			INT
	PRIMARY KEY(SUBJECTID)
)
--
IF EXISTS (SELECT * FROM DBO.SYSOBJECTS WHERE NAME='REGIST')
BEGIN
	DROP TABLE REGIST
END
GO
CREATE TABLE REGIST
(
	STUDENTID	CHAR(5),
	SUBJECTID	CHAR(5)
	PRIMARY KEY(STUDENTID,SUBJECTID)
)

--TAO BANG ACCOUNT
IF EXISTS (SELECT * FROM DBO.SYSOBJECTS WHERE NAME='ACCOUNT')
BEGIN
	DROP TABLE ACCOUNT
END
GO
CREATE TABLE ACCOUNT
(
	USERNAME	VARCHAR(50),
	PASSWORD	VARCHAR(50),
	ROLL		INT,
	STUDENTID	CHAR(5)
	PRIMARY KEY(USERNAME)
)

-- TAO BANG ROLL
IF EXISTS (SELECT * FROM DBO.SYSOBJECTS WHERE NAME='ROLL')
BEGIN
	DROP TABLE ROLL
END
GO
CREATE TABLE ROLL
(
	ROLLID		INT,
	ROLLNAME	NVARCHAR(100)
	PRIMARY KEY(ROLLID)
)
--TAO BANG MENU
IF EXISTS (SELECT * FROM DBO.SYSOBJECTS WHERE NAME='MENU')
BEGIN
	DROP TABLE MENU
END
GO
CREATE TABLE MENU
(
	MENUID		INT,
	MENUNAME	NVARCHAR(50),
	MENULINK	VARCHAR(50)
	PRIMARY KEY(MENUID)
)

--TAO BANG ROLLMENU
IF EXISTS (SELECT * FROM DBO.SYSOBJECTS WHERE NAME='ROLLMENU')
BEGIN
	DROP TABLE ROLLMENU
END
GO
CREATE TABLE ROLLMENU
(
	MENUID	INT,
	ROLLID	INT
	PRIMARY KEY (MENUID,ROLLID)
)

-- THIET LAP KHOA NGOAI REGIST_STUDENT
ALTER TABLE REGIST
ADD CONSTRAINT FK_REGIST_STUDENT
FOREIGN KEY (STUDENTID) REFERENCES STUDENT(STUDENTID)

-- THIET LAP KHOA NGOAI REGIST_SUBJECT
ALTER TABLE REGIST
ADD CONSTRAINT FK_REGIST_SUBJECT
FOREIGN KEY (SUBJECTID) REFERENCES SUBJECT(SUBJECTID)


-- THIET LAP KHOA NGOAI ACCOUNT_STUDENT
ALTER TABLE ACCOUNT
ADD CONSTRAINT FK_ACCOUNT_STUDENT
FOREIGN KEY (STUDENTID) REFERENCES STUDENT(STUDENTID)


-- THIET LAP KHOA NGOAI ACCOUNT_ROLL
ALTER TABLE ACCOUNT
ADD CONSTRAINT FK_ACCOUNT_ROLL
FOREIGN KEY (ROLL) REFERENCES ROLL(ROLLID)

-- THIET LAP KHOA NGOAI ROLLMENU_ROLL
ALTER TABLE ROLLMENU
ADD CONSTRAINT FK_ROLLMENU_ROLL
FOREIGN KEY (ROLLID) REFERENCES ROLL(ROLLID)

-- THIET LAP KHOA NGOAI ROLLMENU_MENU
ALTER TABLE ROLLMENU
ADD CONSTRAINT FK_ROLLMENU_MENU
FOREIGN KEY (MENUID) REFERENCES MENU(MENUID)

--INSERT GIU LIEU STUDENT

INSERT INTO STUDENT(STUDENTID,STUDENTNAME,DOB,SEX,ADDRESS)
VALUES(10001,'NGUYEN VAN LAM','11/30/1989','NAM','273 CMT8 Q3 TPHCM')

INSERT INTO STUDENT(STUDENTID,STUDENTNAME,DOB,SEX,ADDRESS)
VALUES(10002,'NGUYEN VIET LIEN','10/2/2000','NU','1030 TRUONG TRINH Q TANBINH TP HCM')

INSERT INTO STUDENT(STUDENTID,STUDENTNAME,DOB,SEX,ADDRESS)
VALUES(10003,'TRAN VAN TAI','7/19/1986','NAM','897 AU CO QTB TP HCM')

--INSERT GIU LIEU SUBJECT

INSERT INTO SUBJECT(SUBJECTID,SUBJECTNAME,CREDIT,FEE)
VALUES(20001,'TIENG ANH',1,5000)

INSERT INTO SUBJECT(SUBJECTID,SUBJECTNAME,CREDIT,FEE)
VALUES(20002,'TIN HOC',2,4000)

INSERT INTO SUBJECT(SUBJECTID,SUBJECTNAME,CREDIT,FEE)
VALUES(20003,'LUYEN THI DH',3,8000)

--INSERT GIU LIEU REGIST

INSERT INTO REGIST(STUDENTID,SUBJECTID)
VALUES(10001,20001)

INSERT INTO REGIST(STUDENTID,SUBJECTID)
VALUES(10002,20003)

INSERT INTO REGIST(STUDENTID,SUBJECTID)
VALUES(10003,20001)

--INSERT GIU LIEU ROLL
INSERT INTO ROLL(ROLLID,ROLLNAME)
VALUES(1,'ADMIN')

INSERT INTO ROLL(ROLLID,ROLLNAME)
VALUES(2,'MANAGER')


INSERT INTO ROLL(ROLLID,ROLLNAME)
VALUES(3,'USER')


--INSERT GIU LIEU ACCOUNT
INSERT INTO ACCOUNT(USERNAME,PASSWORD,ROLL,STUDENTID)
VALUES('VANLAM','VANLAM123',3,10001)

INSERT INTO ACCOUNT(USERNAME,PASSWORD,ROLL,STUDENTID)
VALUES('VIETLIEN','VIETLIEN123',1,10002)

INSERT INTO ACCOUNT(USERNAME,PASSWORD,ROLL,STUDENTID)
VALUES('VANTAI','VANTAI123',3,10003)

-- GIU LIEU MENU

INSERT INTO MENU(MENUID,MENUNAME,MENULINK)
VALUES(1,'SUA CHUA','http://localhost/project/SUACHUA.php')

INSERT INTO MENU(MENUID,MENUNAME,MENULINK)
VALUES(2,'NHAP LIEU','http://localhost/project/INSERT.php')

INSERT INTO MENU(MENUID,MENUNAME,MENULINK)
VALUES(3,'DANGNHAP','http://localhost/project/DANGNHAP.php')

--GIU LIEU ROLLMENU
INSERT INTO ROLLMENU(MENUID,ROLLID)
VALUES(1,1)

INSERT INTO ROLLMENU(MENUID,ROLLID)
VALUES(2,2)

INSERT INTO ROLLMENU(MENUID,ROLLID)
VALUES(3,3)


